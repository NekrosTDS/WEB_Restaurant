{% extends "base.html" %}
{% block title %}–ê–¥–º—ñ–Ω–ø–∞–Ω–µ–ª—å - –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ{% endblock title %}
{% block content %}
<div class="container">
    <h1 class="my-4">üë• –£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º–∏</h1>

    <div class="table-responsive">
        <table class="table table-striped">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>–Ü–º'—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞</th>
                    <th>Email</th>
                    <th>–°—Ç–∞—Ç—É—Å</th>
                    <th>–î—ñ—ó</th>
                </tr>
            </thead>
            <tbody>
                {% for user in users %}
                <tr>
                    <td>{{ user.id }}</td>
                    <td>{{ user.username }}</td>
                    <td>{{ user.email }}</td>
                    <td>
                        <span class="badge {% if user.is_admin %}bg-success{% else %}bg-secondary{% endif %}">
                            {{ "–ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä" if user.is_admin else "–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á" }}
                        </span>
                    </td>
                    <td>
                        {% if user.is_admin %}
                            {% if user.username != current_user.username %}
                            <form method="POST" action="{{ url_for('admin.toggle_admin_status', user_id=user.id) }}" class="d-inline">
                                <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                                <input type="hidden" name="is_admin" value="false">
                                <button type="submit" class="btn btn-sm btn-warning" onclick="return confirm('–ó–∞–±—Ä–∞—Ç–∏ –ø—Ä–∞–≤–∞ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞ —É –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ {{ user.username }}?')">
                                    –ó–∞–±—Ä–∞—Ç–∏ –∞–¥–º—ñ–Ω –ø—Ä–∞–≤–∞
                                </button>
                            </form>
                            {% else %}
                            <span class="text-muted">–ü–æ—Ç–æ—á–Ω–∏–π –∞–¥–º—ñ–Ω</span>
                            {% endif %}
                        {% else %}
                        <form method="POST" action="{{ url_for('admin.toggle_admin_status', user_id=user.id) }}" class="d-inline">
                            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                            <input type="hidden" name="is_admin" value="true">
                            <button type="submit" class="btn btn-sm btn-success" onclick="return confirm('–ù–∞–¥–∞—Ç–∏ –ø—Ä–∞–≤–∞ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—É {{ user.username }}?')">
                                –ó—Ä–æ–±–∏—Ç–∏ –∞–¥–º—ñ–Ω–æ–º
                            </button>
                        </form>
                        {% endif %}
                        {% if user.username != current_user.username %}
                        <form method="POST" action="{{ url_for('admin.delete_user', user_id=user.id) }}" class="d-inline">
                            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                            <button type="submit" class="btn btn-sm btn-danger" onclick="return confirm('–í–∏–¥–∞–ª–∏—Ç–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ {{ user.username }}? –¶—è –¥—ñ—è –Ω–µ–∑–≤–æ—Ä–æ—Ç–Ω—è!')">
                                üóëÔ∏è –í–∏–¥–∞–ª–∏—Ç–∏
                            </button>
                        </form>
                        {% endif %}
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock content %}
